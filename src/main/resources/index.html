<!DOCTYPE html>
  <head>
    <meta charset="utf-8">
    <title>Contracts</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="/css/main.css">
    <link href='http://fonts.googleapis.com/css?family=Oleo+Script'
          rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lobster+Two'
          rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Just+Another+Hand'
          rel='stylesheet' type='text/css'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.0.3/js.cookie.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>

    <!--
    <script src="/js/jquery-2.1.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.16/browser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.min.js"></script>

    <script src="https://raw.githubusercontent.com/pipwerks/PDFObject/master/pdfobject.min.js"></script>
  -->
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="784978983695-km7e0k6q09qmrmgk3r2aortu0oqdk2tk.apps.googleusercontent.com">
    <meta name="google-signin-hosted_domain" content="ncf.edu">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
  </head>
  <body>
  	<div id="login-area" class="login-area">
		    <div id="login" class="logged-out">
          <div class="g-signin2" id="my-signin" data-onsuccess="onSignIn" data-onfailure="onSignInFailure"
				      data-width="240" data-longtitle="true" data-theme="dark">
          </div>
        </div>
		    <div id="logout" class="logged-in" style="display:none">
			    <p>Welcome <span class="user-full-name">ANON</span>!</p>
			    <a href="#" onclick="signOut();" id="logout-link">Sign out</a>
		    </div>
	  </div>

    <div id="content"></div>

    <script src="/js/googleStuff.js"></script>
    <script src="/js/main.js"></script>

    <script>
      var googleUser = null;
      var gIdToken = null;
      var onSignInExtra = function() {};

      console.log('hey there!');

      function hideLogout() {
        $(".logged-in").hide();
      }

      function newContract() {
          $(".blank-form").show();
      }

      function signOut() {
        console.log('Signing out ' + googleUser.getBasicProfile().getName());
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.disconnect();
        auth2.signOut().then(function() {
          console.log('User signed out.');
        });
        Cookies.remove("id_token3");
        googleUser = null;
        gIdToken = null;
        $(".logged-in").hide();
        $(".logged-out").show();
      }

      function onSignIn(success) {
        console.log(JSON.stringify({message: "success", value: success}));
        googleUser = success;
        gIdToken = googleUser.getAuthResponse().id_token;
        //Cookies.set('id_token3', googleUser.getAuthResponse().id_token, {expires: 7});
        Cookies.set('id_token3', gIdToken, {expires: 7});

        // Useful data for your client-side scripts:
        var profile = googleUser.getBasicProfile();

        $(".logged-in").show();
        $(".logged-out").hide();

        $(".user-full-name").html(profile.getName());

        // The ID token you need to pass to your backend:
        $("#google_id_token").val(gIdToken);
        //gIdToken = id_token;

        $("#firstName").val(profile.getGivenName());
        $("#lastName").val(profile.getFamilyName());
        onSignInExtra();

        Cookies.remove("id_token2");
        Cookies.remove("test_cookie");
        Cookies.remove("SQLiteManager_currentLangue");
        Cookies.remove("G_AUTHUSER_H");
      };

      function onSignInFailure(error) {
        console.log("oops");
        var errorString = "Sorry, something went wrong with the Google sign-in; please let us know about the issue";
        console.log(JSON.stringify({message: "fail", value: error}));
      }
    </script>


  </body>
</html>
